# 关系型数据库（MYSQL）规范

## （一）创建规范

### 1. 建库

#### 1） 命名规则  {业务/应用名称}\_{功能名称}

例如： smsf_authority

#### 2） Collation 推荐选择utf8_general_ci

#### 3）Charset 推荐选择utf8



### 2. 建表

#### 1）命名规则   t\[\_业务/应用名称]{\_功能名称}\[\_表的作用]

#### 2）业务名称和功能名称使用英文单数名词，单词之前使用下划线分隔 

#### 3）只能使用小写字母或数字，但禁止两个下划线中间只出现数字 

例如： t_authority_group,  t_authority_permission_resource



### 3. 字段

#### 1） 只能使用小写字母或数字，单词之前使用下划线分隔， 禁止两个下划线中间只出现数字

#### 2） 每个表中必须有的字段

| 字段名称      | 数据类型     | 备注                       |
| ------------- | ------------ | -------------------------- |
| id            | varchar(128) | 主键                       |
| is_deleted    | tinyint(4)   | 逻辑删除位                 |
| created_by    | varchar(128) | 创建人                     |
| created_time  | date         | 创建时间（数据库自动生成） |
| modified_by   | varchar(128) | 修改人                     |
| modified_time | date         | 修改时间（数据库自动生成） |
| version       | int(8)       | 数据版本                   |





### 4. 索引命名

#### 1） 主键命名以pk\_开头

#### 2） index索引以idx\_开头

#### 3） 自增长列以 ai\_开头

#### 4） 唯一索引名以uk_开头



### 5. 不推荐使用存储过程

存储过程难以扩展和移植



### 6. 不推荐使用数据库级别外键与级联。

外键、级联关系请尽量在应用层解决。



### 7. 小数类型为decimal，不推荐使用float和double

float和double在存储的时候，存在精度损失的问题，很可能在值的比较时，得到不正确的结果。如果存储的数据范围超过decimal的范围，建议将数据拆成整数和小数分开存储



## （二）SQL相关规范

### 8. 数据删除和更新前，先查找到当前数据，对比无误后再执行。如果有需要，请判断version。

分布式情况下，非当前version的数据不要操作，存在脏读和脏写风险。



### 9. 搜索不推荐使用左模糊或者全模糊，如果有需求请尽量使用其他方式解决，如搜索引擎。

索引文件具有B-Tree的最左前缀匹配特性，如果左边的值未确定，那么无法使用此索引。



### 10. 尽量避免in操作

如果无法避免，请注意in中元素的数量控制在1000以内

in操作替换方式，

- exists
- 应用层处理









